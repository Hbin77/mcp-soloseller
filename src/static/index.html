<!DOCTYPE html>
<html lang="ko" x-data="app()" x-init="init()">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÏáºÌïëÎ™∞ ÏûêÎèôÌôî MCP</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    <style>
        [x-cloak] { display: none !important; }
        .sidebar-link.active { background-color: rgb(59 130 246); color: white; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- ÏÇ¨Ïù¥ÎìúÎ∞î -->
    <aside class="fixed left-0 top-0 z-40 h-screen w-64 bg-gray-900 text-white transition-transform"
           :class="{ '-translate-x-full': !sidebarOpen, 'translate-x-0': sidebarOpen }">
        <div class="flex h-16 items-center justify-center border-b border-gray-700">
            <h1 class="text-xl font-bold">üõí ÏáºÌïëÎ™∞ ÏûêÎèôÌôî</h1>
        </div>
        <nav class="p-4 space-y-2">
            <a href="#" @click.prevent="currentPage = 'dashboard'" 
               class="sidebar-link flex items-center gap-3 rounded-lg px-4 py-3 hover:bg-gray-800 transition"
               :class="{ 'active': currentPage === 'dashboard' }">
                <i class="ri-dashboard-line text-xl"></i>
                <span>ÎåÄÏãúÎ≥¥Îìú</span>
            </a>
            <a href="#" @click.prevent="currentPage = 'orders'" 
               class="sidebar-link flex items-center gap-3 rounded-lg px-4 py-3 hover:bg-gray-800 transition"
               :class="{ 'active': currentPage === 'orders' }">
                <i class="ri-shopping-bag-line text-xl"></i>
                <span>Ï£ºÎ¨∏ Í¥ÄÎ¶¨</span>
            </a>
            <a href="#" @click.prevent="currentPage = 'products'" 
               class="sidebar-link flex items-center gap-3 rounded-lg px-4 py-3 hover:bg-gray-800 transition"
               :class="{ 'active': currentPage === 'products' }">
                <i class="ri-archive-line text-xl"></i>
                <span>ÏÉÅÌíà/Ïû¨Í≥†</span>
            </a>
            <a href="#" @click.prevent="currentPage = 'claims'" 
               class="sidebar-link flex items-center gap-3 rounded-lg px-4 py-3 hover:bg-gray-800 transition"
               :class="{ 'active': currentPage === 'claims' }">
                <i class="ri-exchange-line text-xl"></i>
                <span>Î∞òÌíà/ÍµêÌôò</span>
            </a>
            <a href="#" @click.prevent="currentPage = 'settings'" 
               class="sidebar-link flex items-center gap-3 rounded-lg px-4 py-3 hover:bg-gray-800 transition"
               :class="{ 'active': currentPage === 'settings' }">
                <i class="ri-settings-3-line text-xl"></i>
                <span>ÏÑ§Ï†ï</span>
            </a>
        </nav>
        <div class="absolute bottom-0 left-0 right-0 p-4 border-t border-gray-700">
            <div class="text-xs text-gray-400">
                <p>MCP Server v1.0.0</p>
                <p x-text="'ÎßàÏßÄÎßâ ÎèôÍ∏∞Ìôî: ' + lastSync"></p>
            </div>
        </div>
    </aside>

    <!-- Î©îÏù∏ Ïª®ÌÖêÏ∏† -->
    <div class="ml-64">
        <!-- Ìó§Îçî -->
        <header class="sticky top-0 z-30 bg-white shadow-sm">
            <div class="flex h-16 items-center justify-between px-6">
                <button @click="sidebarOpen = !sidebarOpen" class="lg:hidden">
                    <i class="ri-menu-line text-2xl"></i>
                </button>
                <div class="flex items-center gap-4">
                    <span class="text-sm text-gray-500" x-text="new Date().toLocaleDateString('ko-KR', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })"></span>
                </div>
                <div class="flex items-center gap-4">
                    <button @click="refreshData()" class="flex items-center gap-2 rounded-lg bg-blue-500 px-4 py-2 text-white hover:bg-blue-600 transition">
                        <i class="ri-refresh-line"></i>
                        <span>ÏÉàÎ°úÍ≥†Ïπ®</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- ÌéòÏù¥ÏßÄ Ïª®ÌÖêÏ∏† -->
        <main class="p-6">
            <!-- ÎåÄÏãúÎ≥¥Îìú -->
            <div x-show="currentPage === 'dashboard'" x-cloak>
                <h2 class="text-2xl font-bold mb-6">ÎåÄÏãúÎ≥¥Îìú</h2>
                
                <!-- ÏöîÏïΩ Ïπ¥Îìú -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-gray-500">Ïò§Îäò Ï£ºÎ¨∏</p>
                                <p class="text-3xl font-bold text-gray-900" x-text="dashboard.today?.orders || 0"></p>
                            </div>
                            <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center">
                                <i class="ri-shopping-bag-line text-2xl text-blue-500"></i>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-gray-500">Ïò§Îäò Îß§Ï∂ú</p>
                                <p class="text-3xl font-bold text-gray-900" x-text="formatCurrency(dashboard.today?.sales || 0)"></p>
                            </div>
                            <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center">
                                <i class="ri-money-won-circle-line text-2xl text-green-500"></i>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-gray-500">Î∞úÏÜ° ÎåÄÍ∏∞</p>
                                <p class="text-3xl font-bold text-orange-500" x-text="dashboard.pending?.orders || 0"></p>
                            </div>
                            <div class="w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center">
                                <i class="ri-truck-line text-2xl text-orange-500"></i>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-gray-500">Ïû¨Í≥† Î∂ÄÏ°±</p>
                                <p class="text-3xl font-bold" :class="dashboard.alerts?.low_stock > 0 ? 'text-red-500' : 'text-gray-900'" x-text="dashboard.alerts?.low_stock || 0"></p>
                            </div>
                            <div class="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center">
                                <i class="ri-alert-line text-2xl text-red-500"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Ï±ÑÎÑêÎ≥Ñ ÌòÑÌô© -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold mb-4">Ï±ÑÎÑêÎ≥Ñ Ïò§Îäò Ï£ºÎ¨∏</h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center">
                                        <span class="text-green-600 font-bold text-sm">N</span>
                                    </div>
                                    <span class="font-medium">Ïä§ÎßàÌä∏Ïä§ÌÜ†Ïñ¥</span>
                                </div>
                                <div class="text-right">
                                    <p class="font-bold" x-text="(dashboard.today?.by_channel?.naver?.count || 0) + 'Í±¥'"></p>
                                    <p class="text-sm text-gray-500" x-text="formatCurrency(dashboard.today?.by_channel?.naver?.total || 0)"></p>
                                </div>
                            </div>
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center">
                                        <span class="text-red-600 font-bold text-sm">C</span>
                                    </div>
                                    <span class="font-medium">Ïø†Ìå°</span>
                                </div>
                                <div class="text-right">
                                    <p class="font-bold" x-text="(dashboard.today?.by_channel?.coupang?.count || 0) + 'Í±¥'"></p>
                                    <p class="text-sm text-gray-500" x-text="formatCurrency(dashboard.today?.by_channel?.coupang?.total || 0)"></p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold mb-4">Î∞∞Ïπò Ï≤òÎ¶¨</h3>
                        <div class="space-y-4">
                            <button @click="processBatch(1)" class="w-full flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50 transition">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                                        <span class="text-blue-600 font-bold">1Ï∞®</span>
                                    </div>
                                    <div class="text-left">
                                        <p class="font-medium">1Ï∞® ÏÜ°Ïû• Ï≤òÎ¶¨</p>
                                        <p class="text-sm text-gray-500">12:00 Ïä§ÏºÄÏ§Ñ</p>
                                    </div>
                                </div>
                                <i class="ri-play-circle-line text-2xl text-blue-500"></i>
                            </button>
                            <button @click="processBatch(2)" class="w-full flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50 transition">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center">
                                        <span class="text-purple-600 font-bold">2Ï∞®</span>
                                    </div>
                                    <div class="text-left">
                                        <p class="font-medium">2Ï∞® ÏÜ°Ïû• Ï≤òÎ¶¨</p>
                                        <p class="text-sm text-gray-500">15:30 Ïä§ÏºÄÏ§Ñ</p>
                                    </div>
                                </div>
                                <i class="ri-play-circle-line text-2xl text-purple-500"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- ÏµúÍ∑º Ï£ºÎ¨∏ -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-lg font-semibold mb-4">ÏµúÍ∑º Ï£ºÎ¨∏</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b">
                                    <th class="text-left py-3 px-4 text-sm font-medium text-gray-500">Ï±ÑÎÑê</th>
                                    <th class="text-left py-3 px-4 text-sm font-medium text-gray-500">Ï£ºÎ¨∏Î≤àÌò∏</th>
                                    <th class="text-left py-3 px-4 text-sm font-medium text-gray-500">Ï£ºÎ¨∏Ïûê</th>
                                    <th class="text-left py-3 px-4 text-sm font-medium text-gray-500">Í∏àÏï°</th>
                                    <th class="text-left py-3 px-4 text-sm font-medium text-gray-500">ÏÉÅÌÉú</th>
                                    <th class="text-left py-3 px-4 text-sm font-medium text-gray-500">Ï£ºÎ¨∏ÏùºÏãú</th>
                                </tr>
                            </thead>
                            <tbody>
                                <template x-for="order in recentOrders" :key="order.id">
                                    <tr class="border-b hover:bg-gray-50">
                                        <td class="py-3 px-4">
                                            <span class="px-2 py-1 text-xs font-medium rounded"
                                                  :class="order.channel === 'naver' ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'"
                                                  x-text="order.channel === 'naver' ? 'Ïä§ÎßàÌä∏Ïä§ÌÜ†Ïñ¥' : 'Ïø†Ìå°'"></span>
                                        </td>
                                        <td class="py-3 px-4 font-mono text-sm" x-text="order.channel_order_id"></td>
                                        <td class="py-3 px-4" x-text="order.buyer_name"></td>
                                        <td class="py-3 px-4 font-medium" x-text="formatCurrency(order.total_amount)"></td>
                                        <td class="py-3 px-4">
                                            <span class="px-2 py-1 text-xs font-medium rounded"
                                                  :class="getStatusClass(order.status)"
                                                  x-text="getStatusText(order.status)"></span>
                                        </td>
                                        <td class="py-3 px-4 text-sm text-gray-500" x-text="formatDate(order.ordered_at)"></td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Ï£ºÎ¨∏ Í¥ÄÎ¶¨ -->
            <div x-show="currentPage === 'orders'" x-cloak>
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-bold">Ï£ºÎ¨∏ Í¥ÄÎ¶¨</h2>
                    <button @click="collectOrders()" class="flex items-center gap-2 rounded-lg bg-green-500 px-4 py-2 text-white hover:bg-green-600 transition">
                        <i class="ri-download-line"></i>
                        <span>Ï£ºÎ¨∏ ÏàòÏßë</span>
                    </button>
                </div>

                <!-- ÌïÑÌÑ∞ -->
                <div class="bg-white rounded-xl shadow-sm p-4 mb-6">
                    <div class="flex flex-wrap gap-4">
                        <select x-model="orderFilter.status" class="rounded-lg border-gray-300 text-sm">
                            <option value="">Ï†ÑÏ≤¥ ÏÉÅÌÉú</option>
                            <option value="new">Ïã†Í∑ú</option>
                            <option value="confirmed">Î∞úÏ£ºÌôïÏù∏</option>
                            <option value="shipped">Î∞úÏÜ°ÏôÑÎ£å</option>
                            <option value="delivered">Î∞∞ÏÜ°ÏôÑÎ£å</option>
                        </select>
                        <select x-model="orderFilter.channel" class="rounded-lg border-gray-300 text-sm">
                            <option value="">Ï†ÑÏ≤¥ Ï±ÑÎÑê</option>
                            <option value="naver">Ïä§ÎßàÌä∏Ïä§ÌÜ†Ïñ¥</option>
                            <option value="coupang">Ïø†Ìå°</option>
                        </select>
                        <input type="text" x-model="orderFilter.search" placeholder="Í≤ÄÏÉâ..." 
                               class="rounded-lg border-gray-300 text-sm" @keyup.enter="loadOrders()">
                        <button @click="loadOrders()" class="px-4 py-2 bg-gray-800 text-white rounded-lg text-sm hover:bg-gray-700">
                            Í≤ÄÏÉâ
                        </button>
                    </div>
                </div>

                <!-- Ï£ºÎ¨∏ Î™©Î°ù -->
                <div class="bg-white rounded-xl shadow-sm">
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b bg-gray-50">
                                    <th class="text-left py-3 px-4 text-sm font-medium text-gray-500">Ï±ÑÎÑê</th>
                                    <th class="text-left py-3 px-4 text-sm font-medium text-gray-500">Ï£ºÎ¨∏Î≤àÌò∏</th>
                                    <th class="text-left py-3 px-4 text-sm font-medium text-gray-500">Ï£ºÎ¨∏Ïûê</th>
                                    <th class="text-left py-3 px-4 text-sm font-medium text-gray-500">ÏàòÎ†πÏù∏</th>
                                    <th class="text-left py-3 px-4 text-sm font-medium text-gray-500">Í∏àÏï°</th>
                                    <th class="text-left py-3 px-4 text-sm font-medium text-gray-500">ÏÉÅÌÉú</th>
                                    <th class="text-left py-3 px-4 text-sm font-medium text-gray-500">ÏÜ°Ïû•Î≤àÌò∏</th>
                                    <th class="text-left py-3 px-4 text-sm font-medium text-gray-500">Ï£ºÎ¨∏ÏùºÏãú</th>
                                </tr>
                            </thead>
                            <tbody>
                                <template x-for="order in orders" :key="order.id">
                                    <tr class="border-b hover:bg-gray-50 cursor-pointer" @click="showOrderDetail(order)">
                                        <td class="py-3 px-4">
                                            <span class="px-2 py-1 text-xs font-medium rounded"
                                                  :class="order.channel === 'naver' ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'"
                                                  x-text="order.channel === 'naver' ? 'N' : 'C'"></span>
                                        </td>
                                        <td class="py-3 px-4 font-mono text-sm" x-text="order.channel_order_id"></td>
                                        <td class="py-3 px-4" x-text="order.buyer_name"></td>
                                        <td class="py-3 px-4" x-text="order.receiver_name"></td>
                                        <td class="py-3 px-4 font-medium" x-text="formatCurrency(order.total_amount)"></td>
                                        <td class="py-3 px-4">
                                            <span class="px-2 py-1 text-xs font-medium rounded"
                                                  :class="getStatusClass(order.status)"
                                                  x-text="getStatusText(order.status)"></span>
                                        </td>
                                        <td class="py-3 px-4 font-mono text-sm" x-text="order.tracking_number || '-'"></td>
                                        <td class="py-3 px-4 text-sm text-gray-500" x-text="formatDate(order.ordered_at)"></td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>
                    <!-- ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò -->
                    <div class="flex items-center justify-between px-4 py-3 border-t">
                        <p class="text-sm text-gray-500">
                            Ï¥ù <span x-text="orderPagination.total"></span>Í±¥
                        </p>
                        <div class="flex gap-2">
                            <button @click="orderPagination.page > 1 && (orderPagination.page--, loadOrders())"
                                    :disabled="orderPagination.page <= 1"
                                    class="px-3 py-1 border rounded text-sm disabled:opacity-50">Ïù¥Ï†Ñ</button>
                            <span class="px-3 py-1 text-sm" x-text="orderPagination.page + ' / ' + orderPagination.pages"></span>
                            <button @click="orderPagination.page < orderPagination.pages && (orderPagination.page++, loadOrders())"
                                    :disabled="orderPagination.page >= orderPagination.pages"
                                    class="px-3 py-1 border rounded text-sm disabled:opacity-50">Îã§Ïùå</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ÏÉÅÌíà/Ïû¨Í≥† Í¥ÄÎ¶¨ -->
            <div x-show="currentPage === 'products'" x-cloak>
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-bold">ÏÉÅÌíà/Ïû¨Í≥† Í¥ÄÎ¶¨</h2>
                    <div class="flex gap-2">
                        <button @click="showAddProduct = true" class="flex items-center gap-2 rounded-lg bg-blue-500 px-4 py-2 text-white hover:bg-blue-600 transition">
                            <i class="ri-add-line"></i>
                            <span>ÏÉÅÌíà Îì±Î°ù</span>
                        </button>
                        <button @click="syncStock()" class="flex items-center gap-2 rounded-lg bg-green-500 px-4 py-2 text-white hover:bg-green-600 transition">
                            <i class="ri-refresh-line"></i>
                            <span>Ï±ÑÎÑê ÎèôÍ∏∞Ìôî</span>
                        </button>
                    </div>
                </div>

                <!-- Ïû¨Í≥† Î∂ÄÏ°± ÏïåÎ¶º -->
                <div x-show="lowStockProducts.length > 0" class="bg-red-50 border border-red-200 rounded-xl p-4 mb-6">
                    <div class="flex items-center gap-2 text-red-700 mb-2">
                        <i class="ri-alert-fill"></i>
                        <span class="font-semibold">Ïû¨Í≥† Î∂ÄÏ°± ÏÉÅÌíà</span>
                    </div>
                    <div class="flex flex-wrap gap-2">
                        <template x-for="p in lowStockProducts" :key="p.id">
                            <span class="px-3 py-1 bg-red-100 text-red-700 rounded-full text-sm">
                                <span x-text="p.name"></span>: <span x-text="p.stock_quantity"></span>Í∞ú
                            </span>
                        </template>
                    </div>
                </div>

                <!-- ÏÉÅÌíà Î™©Î°ù -->
                <div class="bg-white rounded-xl shadow-sm">
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b bg-gray-50">
                                    <th class="text-left py-3 px-4 text-sm font-medium text-gray-500">SKU</th>
                                    <th class="text-left py-3 px-4 text-sm font-medium text-gray-500">ÏÉÅÌíàÎ™Ö</th>
                                    <th class="text-left py-3 px-4 text-sm font-medium text-gray-500">Ïû¨Í≥†</th>
                                    <th class="text-left py-3 px-4 text-sm font-medium text-gray-500">Í∞ÄÍ≤©</th>
                                    <th class="text-left py-3 px-4 text-sm font-medium text-gray-500">Ï±ÑÎÑê Ïó∞Îèô</th>
                                    <th class="text-left py-3 px-4 text-sm font-medium text-gray-500">ÏûëÏóÖ</th>
                                </tr>
                            </thead>
                            <tbody>
                                <template x-for="product in products" :key="product.id">
                                    <tr class="border-b hover:bg-gray-50">
                                        <td class="py-3 px-4 font-mono text-sm" x-text="product.sku"></td>
                                        <td class="py-3 px-4" x-text="product.name"></td>
                                        <td class="py-3 px-4">
                                            <span class="font-bold" :class="product.is_low_stock ? 'text-red-500' : 'text-gray-900'"
                                                  x-text="product.stock_quantity + 'Í∞ú'"></span>
                                            <span x-show="product.is_low_stock" class="ml-2 text-xs text-red-500">‚ö†Ô∏è Î∂ÄÏ°±</span>
                                        </td>
                                        <td class="py-3 px-4" x-text="formatCurrency(product.price)"></td>
                                        <td class="py-3 px-4">
                                            <span x-show="product.naver_product_id" class="px-2 py-1 text-xs bg-green-100 text-green-700 rounded mr-1">N</span>
                                            <span x-show="product.coupang_product_id" class="px-2 py-1 text-xs bg-red-100 text-red-700 rounded">C</span>
                                        </td>
                                        <td class="py-3 px-4">
                                            <button @click="showStockUpdate(product)" class="text-blue-500 hover:text-blue-700 mr-2">
                                                <i class="ri-edit-line"></i>
                                            </button>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ÌÅ¥Î†àÏûÑ Í¥ÄÎ¶¨ -->
            <div x-show="currentPage === 'claims'" x-cloak>
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-bold">Î∞òÌíà/ÍµêÌôò Í¥ÄÎ¶¨</h2>
                    <button @click="syncClaims()" class="flex items-center gap-2 rounded-lg bg-blue-500 px-4 py-2 text-white hover:bg-blue-600 transition">
                        <i class="ri-refresh-line"></i>
                        <span>ÌÅ¥Î†àÏûÑ ÎèôÍ∏∞Ìôî</span>
                    </button>
                </div>

                <div class="bg-white rounded-xl shadow-sm">
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b bg-gray-50">
                                    <th class="text-left py-3 px-4 text-sm font-medium text-gray-500">Ï±ÑÎÑê</th>
                                    <th class="text-left py-3 px-4 text-sm font-medium text-gray-500">Ï£ºÎ¨∏Î≤àÌò∏</th>
                                    <th class="text-left py-3 px-4 text-sm font-medium text-gray-500">Ïú†Ìòï</th>
                                    <th class="text-left py-3 px-4 text-sm font-medium text-gray-500">ÏÇ¨Ïú†</th>
                                    <th class="text-left py-3 px-4 text-sm font-medium text-gray-500">ÏÉÅÌÉú</th>
                                    <th class="text-left py-3 px-4 text-sm font-medium text-gray-500">ÏöîÏ≤≠ÏùºÏãú</th>
                                </tr>
                            </thead>
                            <tbody>
                                <template x-for="claim in claims" :key="claim.claim_id">
                                    <tr class="border-b hover:bg-gray-50">
                                        <td class="py-3 px-4">
                                            <span class="px-2 py-1 text-xs font-medium rounded"
                                                  :class="claim.channel === 'naver' ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'"
                                                  x-text="claim.channel === 'naver' ? 'N' : 'C'"></span>
                                        </td>
                                        <td class="py-3 px-4 font-mono text-sm" x-text="claim.order_id"></td>
                                        <td class="py-3 px-4">
                                            <span class="px-2 py-1 text-xs font-medium rounded"
                                                  :class="{'bg-orange-100 text-orange-700': claim.type === 'return', 'bg-blue-100 text-blue-700': claim.type === 'exchange', 'bg-gray-100 text-gray-700': claim.type === 'cancel'}"
                                                  x-text="{'return': 'Î∞òÌíà', 'exchange': 'ÍµêÌôò', 'cancel': 'Ï∑®ÏÜå'}[claim.type]"></span>
                                        </td>
                                        <td class="py-3 px-4 text-sm" x-text="claim.reason || '-'"></td>
                                        <td class="py-3 px-4 text-sm" x-text="claim.status"></td>
                                        <td class="py-3 px-4 text-sm text-gray-500" x-text="formatDate(claim.requested_at)"></td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ÏÑ§Ï†ï -->
            <div x-show="currentPage === 'settings'" x-cloak>
                <h2 class="text-2xl font-bold mb-6">ÏÑ§Ï†ï</h2>

                <div class="space-y-6">
                    <!-- Ïó∞Í≤∞ ÏÉÅÌÉú -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold mb-4">Ïó∞Í≤∞ ÏÉÅÌÉú</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="flex items-center gap-3 p-4 border rounded-lg">
                                <div class="w-3 h-3 rounded-full" :class="connectionStatus.naver?.connected ? 'bg-green-500' : 'bg-red-500'"></div>
                                <div>
                                    <p class="font-medium">Ïä§ÎßàÌä∏Ïä§ÌÜ†Ïñ¥</p>
                                    <p class="text-sm text-gray-500" x-text="connectionStatus.naver?.message || 'ÌôïÏù∏ Ï§ë...'"></p>
                                </div>
                            </div>
                            <div class="flex items-center gap-3 p-4 border rounded-lg">
                                <div class="w-3 h-3 rounded-full" :class="connectionStatus.coupang?.connected ? 'bg-green-500' : 'bg-red-500'"></div>
                                <div>
                                    <p class="font-medium">Ïø†Ìå°</p>
                                    <p class="text-sm text-gray-500" x-text="connectionStatus.coupang?.message || 'ÌôïÏù∏ Ï§ë...'"></p>
                                </div>
                            </div>
                            <div class="flex items-center gap-3 p-4 border rounded-lg">
                                <div class="w-3 h-3 rounded-full" :class="connectionStatus.telegram?.connected ? 'bg-green-500' : 'bg-red-500'"></div>
                                <div>
                                    <p class="font-medium">ÌÖîÎ†àÍ∑∏Îû®</p>
                                    <p class="text-sm text-gray-500" x-text="connectionStatus.telegram?.message || 'ÌôïÏù∏ Ï§ë...'"></p>
                                </div>
                            </div>
                        </div>
                        <button @click="checkConnection()" class="mt-4 text-blue-500 hover:text-blue-700 text-sm">
                            <i class="ri-refresh-line mr-1"></i>Ïó∞Í≤∞ ÏÉÅÌÉú ÌôïÏù∏
                        </button>
                    </div>

                    <!-- ÎÑ§Ïù¥Î≤Ñ ÏÑ§Ï†ï -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold mb-4">üü¢ ÎÑ§Ïù¥Î≤Ñ Ïä§ÎßàÌä∏Ïä§ÌÜ†Ïñ¥ API</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Client ID</label>
                                <input type="text" x-model="settingsForm.naver.client_id" class="w-full rounded-lg border-gray-300">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Client Secret</label>
                                <input type="password" x-model="settingsForm.naver.client_secret" class="w-full rounded-lg border-gray-300">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Seller ID</label>
                                <input type="text" x-model="settingsForm.naver.seller_id" class="w-full rounded-lg border-gray-300">
                            </div>
                            <button @click="saveNaverSettings()" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600">
                                Ï†ÄÏû•
                            </button>
                        </div>
                    </div>

                    <!-- Ïø†Ìå° ÏÑ§Ï†ï -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold mb-4">üî¥ Ïø†Ìå° WING API</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Vendor ID</label>
                                <input type="text" x-model="settingsForm.coupang.vendor_id" class="w-full rounded-lg border-gray-300">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Access Key</label>
                                <input type="password" x-model="settingsForm.coupang.access_key" class="w-full rounded-lg border-gray-300">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Secret Key</label>
                                <input type="password" x-model="settingsForm.coupang.secret_key" class="w-full rounded-lg border-gray-300">
                            </div>
                            <button @click="saveCoupangSettings()" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600">
                                Ï†ÄÏû•
                            </button>
                        </div>
                    </div>

                    <!-- ÌÖîÎ†àÍ∑∏Îû® ÏÑ§Ï†ï -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold mb-4">üì± ÌÖîÎ†àÍ∑∏Îû® ÏïåÎ¶º</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Bot Token</label>
                                <input type="password" x-model="settingsForm.telegram.bot_token" class="w-full rounded-lg border-gray-300">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Chat ID</label>
                                <input type="text" x-model="settingsForm.telegram.chat_id" class="w-full rounded-lg border-gray-300">
                            </div>
                            <button @click="saveTelegramSettings()" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">
                                Ï†ÄÏû• Î∞è ÌÖåÏä§Ìä∏
                            </button>
                        </div>
                    </div>

                    <!-- Ïä§ÏºÄÏ§Ñ ÏÑ§Ï†ï -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold mb-4">‚è∞ Ïä§ÏºÄÏ§Ñ ÏÑ§Ï†ï</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">1Ï∞® ÏÜ°Ïû• Ï≤òÎ¶¨</label>
                                <input type="time" x-model="settingsForm.schedule.first_batch" class="w-full rounded-lg border-gray-300">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">2Ï∞® ÏÜ°Ïû• Ï≤òÎ¶¨</label>
                                <input type="time" x-model="settingsForm.schedule.second_batch" class="w-full rounded-lg border-gray-300">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Î∞∞ÏÜ° Ï∂îÏ†Å Í∞ÑÍ≤©(Î∂Ñ)</label>
                                <input type="number" x-model="settingsForm.schedule.tracking_interval" class="w-full rounded-lg border-gray-300">
                            </div>
                        </div>
                        <button @click="saveScheduleSettings()" class="mt-4 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600">
                            Ï†ÄÏû•
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- ÌÜ†Ïä§Ìä∏ ÏïåÎ¶º -->
    <div x-show="toast.show" x-transition class="fixed bottom-4 right-4 z-50">
        <div class="px-6 py-4 rounded-lg shadow-lg" 
             :class="toast.type === 'success' ? 'bg-green-500' : toast.type === 'error' ? 'bg-red-500' : 'bg-blue-500'"
             class="text-white">
            <span x-text="toast.message"></span>
        </div>
    </div>

    <!-- ÏÉÅÌíà Îì±Î°ù Î™®Îã¨ -->
    <div x-show="showAddProduct" x-cloak class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50">
        <div class="bg-white rounded-xl shadow-xl w-full max-w-md p-6" @click.away="showAddProduct = false">
            <h3 class="text-lg font-semibold mb-4">ÏÉÅÌíà Îì±Î°ù</h3>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">SKU *</label>
                    <input type="text" x-model="newProduct.sku" class="w-full rounded-lg border-gray-300">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">ÏÉÅÌíàÎ™Ö *</label>
                    <input type="text" x-model="newProduct.name" class="w-full rounded-lg border-gray-300">
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Ï¥àÍ∏∞ Ïû¨Í≥†</label>
                        <input type="number" x-model="newProduct.stock_quantity" class="w-full rounded-lg border-gray-300">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Í∞ÄÍ≤©</label>
                        <input type="number" x-model="newProduct.price" class="w-full rounded-lg border-gray-300">
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">ÎÑ§Ïù¥Î≤Ñ ÏÉÅÌíàID</label>
                    <input type="text" x-model="newProduct.naver_product_id" class="w-full rounded-lg border-gray-300">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Ïø†Ìå° ÏÉÅÌíàID</label>
                    <input type="text" x-model="newProduct.coupang_product_id" class="w-full rounded-lg border-gray-300">
                </div>
            </div>
            <div class="flex justify-end gap-2 mt-6">
                <button @click="showAddProduct = false" class="px-4 py-2 border rounded-lg">Ï∑®ÏÜå</button>
                <button @click="addProduct()" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">Îì±Î°ù</button>
            </div>
        </div>
    </div>

    <script>
    function app() {
        return {
            // ÏÉÅÌÉú
            sidebarOpen: true,
            currentPage: 'dashboard',
            lastSync: '-',
            
            // Îç∞Ïù¥ÌÑ∞
            dashboard: {},
            recentOrders: [],
            orders: [],
            orderPagination: { page: 1, limit: 20, total: 0, pages: 0 },
            orderFilter: { status: '', channel: '', search: '' },
            products: [],
            lowStockProducts: [],
            claims: [],
            connectionStatus: {},
            
            // Ìèº
            settingsForm: {
                naver: { client_id: '', client_secret: '', seller_id: '' },
                coupang: { vendor_id: '', access_key: '', secret_key: '' },
                telegram: { bot_token: '', chat_id: '' },
                schedule: { first_batch: '12:00', second_batch: '15:30', tracking_interval: 30 }
            },
            newProduct: { sku: '', name: '', stock_quantity: 0, price: 0, naver_product_id: '', coupang_product_id: '' },
            
            // UI
            toast: { show: false, message: '', type: 'info' },
            showAddProduct: false,
            
            async init() {
                await this.refreshData();
            },
            
            async refreshData() {
                await Promise.all([
                    this.loadDashboard(),
                    this.loadRecentOrders(),
                    this.loadOrders(),
                    this.loadProducts(),
                    this.loadLowStock()
                ]);
                this.lastSync = new Date().toLocaleTimeString('ko-KR');
            },
            
            async loadDashboard() {
                try {
                    const res = await fetch('/api/v1/dashboard/summary');
                    this.dashboard = await res.json();
                } catch (e) { console.error(e); }
            },
            
            async loadRecentOrders() {
                try {
                    const res = await fetch('/api/v1/dashboard/recent-orders?limit=5');
                    this.recentOrders = await res.json();
                } catch (e) { console.error(e); }
            },
            
            async loadOrders() {
                try {
                    const params = new URLSearchParams({
                        page: this.orderPagination.page,
                        limit: this.orderPagination.limit,
                        ...this.orderFilter
                    });
                    const res = await fetch('/api/v1/orders?' + params);
                    const data = await res.json();
                    this.orders = data.orders;
                    this.orderPagination.total = data.total;
                    this.orderPagination.pages = data.pages;
                } catch (e) { console.error(e); }
            },
            
            async loadProducts() {
                try {
                    const res = await fetch('/api/v1/products?limit=100');
                    const data = await res.json();
                    this.products = data.products;
                } catch (e) { console.error(e); }
            },
            
            async loadLowStock() {
                try {
                    const res = await fetch('/api/v1/products/low-stock');
                    const data = await res.json();
                    this.lowStockProducts = data.products;
                } catch (e) { console.error(e); }
            },
            
            async collectOrders() {
                try {
                    const res = await fetch('/api/v1/orders/collect', { method: 'POST' });
                    const data = await res.json();
                    this.showToast(data.message, 'success');
                    await this.loadOrders();
                    await this.loadDashboard();
                } catch (e) { this.showToast('Ï£ºÎ¨∏ ÏàòÏßë Ïã§Ìå®', 'error'); }
            },
            
            async processBatch(num) {
                if (!confirm(`${num}Ï∞® ÏÜ°Ïû• Ï≤òÎ¶¨Î•º Ïã§ÌñâÌïòÏãúÍ≤†ÏäµÎãàÍπå?`)) return;
                try {
                    const res = await fetch(`/api/v1/orders/process-batch/${num}`, { method: 'POST' });
                    const data = await res.json();
                    this.showToast(data.message, 'success');
                    await this.refreshData();
                } catch (e) { this.showToast('Ï≤òÎ¶¨ Ïã§Ìå®', 'error'); }
            },
            
            async addProduct() {
                try {
                    const res = await fetch('/api/v1/products', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(this.newProduct)
                    });
                    const data = await res.json();
                    if (data.success) {
                        this.showToast('ÏÉÅÌíàÏù¥ Îì±Î°ùÎêòÏóàÏäµÎãàÎã§', 'success');
                        this.showAddProduct = false;
                        this.newProduct = { sku: '', name: '', stock_quantity: 0, price: 0, naver_product_id: '', coupang_product_id: '' };
                        await this.loadProducts();
                    } else {
                        this.showToast(data.detail || 'Îì±Î°ù Ïã§Ìå®', 'error');
                    }
                } catch (e) { this.showToast('Îì±Î°ù Ïã§Ìå®', 'error'); }
            },
            
            async syncStock() {
                try {
                    const res = await fetch('/api/v1/products/sync-channels', { method: 'POST' });
                    const data = await res.json();
                    this.showToast(`ÎèôÍ∏∞Ìôî ÏôÑÎ£å (ÎÑ§Ïù¥Î≤Ñ: ${data.results.naver}, Ïø†Ìå°: ${data.results.coupang})`, 'success');
                } catch (e) { this.showToast('ÎèôÍ∏∞Ìôî Ïã§Ìå®', 'error'); }
            },
            
            async syncClaims() {
                try {
                    const res = await fetch('/api/v1/claims/sync');
                    const data = await res.json();
                    this.claims = data.claims;
                    this.showToast(`${data.count}Í±¥Ïùò ÌÅ¥Î†àÏûÑÏùÑ ÎèôÍ∏∞ÌôîÌñàÏäµÎãàÎã§`, 'success');
                } catch (e) { this.showToast('ÎèôÍ∏∞Ìôî Ïã§Ìå®', 'error'); }
            },
            
            async checkConnection() {
                try {
                    const res = await fetch('/api/v1/settings/status');
                    this.connectionStatus = await res.json();
                } catch (e) { console.error(e); }
            },
            
            async saveNaverSettings() {
                try {
                    const res = await fetch('/api/v1/settings/naver', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(this.settingsForm.naver)
                    });
                    const data = await res.json();
                    this.showToast(data.message, data.success ? 'success' : 'error');
                    await this.checkConnection();
                } catch (e) { this.showToast('Ï†ÄÏû• Ïã§Ìå®', 'error'); }
            },
            
            async saveCoupangSettings() {
                try {
                    const res = await fetch('/api/v1/settings/coupang', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(this.settingsForm.coupang)
                    });
                    const data = await res.json();
                    this.showToast(data.message, data.success ? 'success' : 'error');
                    await this.checkConnection();
                } catch (e) { this.showToast('Ï†ÄÏû• Ïã§Ìå®', 'error'); }
            },
            
            async saveTelegramSettings() {
                try {
                    const res = await fetch('/api/v1/settings/telegram', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(this.settingsForm.telegram)
                    });
                    const data = await res.json();
                    this.showToast(data.message, data.success ? 'success' : 'error');
                    await this.checkConnection();
                } catch (e) { this.showToast('Ï†ÄÏû• Ïã§Ìå®', 'error'); }
            },
            
            async saveScheduleSettings() {
                try {
                    const res = await fetch('/api/v1/settings/schedule', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(this.settingsForm.schedule)
                    });
                    const data = await res.json();
                    this.showToast(data.message, data.success ? 'success' : 'error');
                } catch (e) { this.showToast('Ï†ÄÏû• Ïã§Ìå®', 'error'); }
            },
            
            showOrderDetail(order) {
                // TODO: Ï£ºÎ¨∏ ÏÉÅÏÑ∏ Î™®Îã¨
                console.log(order);
            },
            
            showStockUpdate(product) {
                const qty = prompt(`${product.name} Ïû¨Í≥† Î≥ÄÍ≤ΩÎüâÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî (ÏûÖÍ≥†: ÏñëÏàò, Ï°∞Ï†ï: ÏùåÏàò):`, '0');
                if (qty !== null) {
                    this.updateStock(product.id, parseInt(qty));
                }
            },
            
            async updateStock(productId, quantity) {
                try {
                    const res = await fetch(`/api/v1/products/${productId}/stock`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ quantity, reason: quantity > 0 ? 'incoming' : 'adjustment' })
                    });
                    const data = await res.json();
                    if (data.success) {
                        this.showToast(`Ïû¨Í≥† Î≥ÄÍ≤Ω: ${data.stock.before} ‚Üí ${data.stock.after}`, 'success');
                        await this.loadProducts();
                        await this.loadLowStock();
                    }
                } catch (e) { this.showToast('Ïû¨Í≥† Î≥ÄÍ≤Ω Ïã§Ìå®', 'error'); }
            },
            
            showToast(message, type = 'info') {
                this.toast = { show: true, message, type };
                setTimeout(() => { this.toast.show = false; }, 3000);
            },
            
            formatCurrency(value) {
                return new Intl.NumberFormat('ko-KR', { style: 'currency', currency: 'KRW' }).format(value || 0);
            },
            
            formatDate(dateStr) {
                if (!dateStr) return '-';
                return new Date(dateStr).toLocaleString('ko-KR');
            },
            
            getStatusText(status) {
                const map = { new: 'Ïã†Í∑ú', confirmed: 'Î∞úÏ£ºÌôïÏù∏', shipped: 'Î∞úÏÜ°ÏôÑÎ£å', delivering: 'Î∞∞ÏÜ°Ï§ë', delivered: 'Î∞∞ÏÜ°ÏôÑÎ£å', cancelled: 'Ï∑®ÏÜå' };
                return map[status] || status;
            },
            
            getStatusClass(status) {
                const map = {
                    new: 'bg-yellow-100 text-yellow-700',
                    confirmed: 'bg-blue-100 text-blue-700',
                    shipped: 'bg-purple-100 text-purple-700',
                    delivering: 'bg-indigo-100 text-indigo-700',
                    delivered: 'bg-green-100 text-green-700',
                    cancelled: 'bg-gray-100 text-gray-700'
                };
                return map[status] || 'bg-gray-100 text-gray-700';
            }
        }
    }
    </script>
</body>
</html>
